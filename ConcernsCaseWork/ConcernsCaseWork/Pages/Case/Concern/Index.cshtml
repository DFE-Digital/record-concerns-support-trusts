@page "/case/concern/{handler?}"
@using ConcernsCaseWork.Constants;
@using Microsoft.AspNetCore.Mvc.TagHelpers
@using NetEscapades.AspNetCore.SecurityHeaders
@model ConcernsCaseWork.Pages.Case.Concern.IndexPageModel

@{
	ViewData["Title"] = "New Case Concern";
	var nonce = HttpContext.GetNonce();
}

<div class="govuk-width-container">
	<partial name="_BannerError"/>
	
	<span class="govuk-caption-l">Create case</span>
	<h1 class="govuk-heading-l">Add concern</h1>

	@if (!string.IsNullOrEmpty((string)TempData.Peek("Error.Message")))
	{
		<partial name="_Error" />
	}
	else
	{
        <partial name="_ValidationErrors" />

		<!-- Trust summary and records -->
		<dl class="govuk-summary-list">
			<div class="govuk-summary-list__row">
            	<dt class="govuk-summary-list__key">Trust</dt>
            	<dd class="govuk-summary-list__value" data-testid="trust-summary">
	                @Model.TrustAddress.TrustName @Model.TrustAddress.County
            		<br/>
            		@Model.TrustAddress.DisplayAddress
            	</dd>
            </div>
			<partial name="_RecordsSummary" model="Model.CreateRecordsModel"/>
		</dl>
		
		<h2 class="govuk-heading-m govuk-!-margin-top-6">Select concern</h2>
		
		<!-- FORM -->
		<form role="form" method="post" id="case-concern-form" novalidate>
			
            @*
			<!--Q Concern type-->
			<div class="govuk-form-group govuk-!-margin-top-6">
				<fieldset class="govuk-fieldset">

					<div class="govuk-hint" id="case-issue-hint">
						Use the
                        <a target="_blank" href="@ResourceConstants.RiskManagementFrameworkLink" class="govuk-link" rel="noreferrer noopener">
							Risk Management Framework (opens in new tab)
						</a> to assess the type of concern
					</div>

					<partial name="_Concern" model="@Model.TypeModel" />

				</fieldset>
			</div>
            *@

            <partial name="Components/_RadioList" model="Model.ConcernType" />

            <partial name="Components/_RadioList" model="Model.ConcernRiskRating" />

            <partial name="Components/_RadioList" model="Model.MeansOfReferral" />

			<div class="govuk-button-group">
				<button id="add-concern-button" data-prevent-double-click="true" class="govuk-button govuk-!-margin-top-6" data-module="govuk-button" role="button" data-testid="add-concern-button">
					Add concern
				</button>
				<a data-prevent-double-click="true" class="govuk-link" asp-page-handler="Cancel" data-module="govuk-button" role="button" data-testid="cancel-button">
					Cancel
				</a>
			</div>

		</form>
		
		<script type="application/javascript" nonce="@nonce">
			$(function () {
                var submitButton = $('#add-concern-button')[0];
                disableOnSubmit(submitButton);
			});
		</script>
	}
</div>