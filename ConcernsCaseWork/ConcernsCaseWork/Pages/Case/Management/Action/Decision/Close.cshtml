@page "/case/{urn:long}/management/action/decision/{decisionId:long?}/close"
@model ConcernsCaseWork.Pages.Case.Management.Action.Decision.ClosePageModel;
@using Microsoft.AspNetCore.Mvc.TagHelpers;
@using NetEscapades.AspNetCore.SecurityHeaders;

@{
	var nonce = HttpContext.GetNonce();

	var decisionsValidationErrors = TempData["Decision.Message"] as IEnumerable<string>;
}

@section BeforeMain {
	<div class="govuk-width-container">
		<a id="back-to-case-link" class="govuk-back-link" href="/case/@Model.CaseUrn/management">
			Back to case
		</a>
	</div>
}

	<div class="govuk-width-container">
		<partial name="_BannerError" />

		<div class="govuk-grid-row">
			<div class="govuk-grid-column-two-thirds">

			@if (!string.IsNullOrEmpty((string)TempData.Peek("Error.Message")))
			{
				<partial name="_Error" />
			}
			else
			{
				<form role="form" method="post" id="add-decision-form" novalidate>
					
					<h1 class="govuk-heading-l">
						<span class="govuk-caption-m">Case ID @@Model.CaseUrn</span>
						Decision
					</h1>
					
					<partial name="_ValidationErrors"/>
					
					@* Notes *@
					<div class="govuk-character-count govuk-!-margin-top-9" data-module="govuk-character-count" data-maxlength="@Model.NotesMaxLength">
						<div class="govuk-form-group">
							<h2 class="govuk-heading-m">Supporting notes</h2>
							<textarea class="govuk-textarea govuk-js-character-count concern-auto-resize" id="case-decision-notes" name="Decision.SupportingNotes" rows="3" aria-describedby="case-decision-notes-info">@Model.Notes</textarea>
						</div>
						<div id="case-decision-notes-info" class="govuk-hint govuk-character-count__message" aria-live="polite">
							You can enter up to @Model.NotesMaxLength characters
						</div>
					</div>

					<div class="govuk-button-group">
						<button data-prevent-double-click="true" class="govuk-button govuk-!-margin-top-6" data-module="govuk-button" role="button" id="add-decision-button" name="action">
							Close decision
						</button>
					</div>
				</form>
			}

		</div>
	</div>
</div>
